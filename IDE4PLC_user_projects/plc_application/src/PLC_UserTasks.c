/* ------------------------------------------------------------ * PLC_UserTasks.c * * Created on: 2016-11-29T21:54:00.196794-03:00 *  * This file is generated automatically by IDE4PLC. *   IDE4PLC website: http://ide4plc.wordpress.com/ *   IDE4PLC e-mail: http://ide4plc.gmail.com  * -----------------------------------------------------------*/	/* En este archivo se guardan las declaraciones de funciones * en C de las Tareas (TASK) del PLC creadas por el usuario.*//*==================[inclusions]=============================================*/#include "os.h"               /* <= operating system header */#include "ciaaPOSIX_stdio.h"  /* <= device handler header */#include "ciaaPOSIX_string.h" /* <= string header */#include "ciaak.h"            /* <= ciaa kernel header */#include "PLC_App_Lib.h"/* Las entradas y salidas fisicas del PLC son variables Globales publicas del tipo volatile */volatile PLC_BYTE digitalInputs;volatile PLC_BYTE digitalOutputs;/* Registros de I/O y Memoria como variables globales publicas */PLC_1ByteRegister  I0;PLC_1ByteRegister  Q0;PLC_1KByteRegister M0;/* PLC Current Result */extern PLC_SymbolicRegister CR;/* PLC_TimersTime variable that counts time in milliseconds for PLC Timers */extern uint64_t PLC_TimersTime;/* Declaraciones de variables simbolicas localizadas */	/*-------------------------------------------------------------------*//* DECLARACIONES DE INSTANCIAS DE LOS PROGRAMAS ASOCIADOS A LA TAREA */PLC_P_Struct_MAIN_PROG_BOOL MAIN_PROG_BOOL_VAR; 			/*-------------------------------------------------------------------*//* Definiciones de funciones de tareas de OSEK que implementan las Tareas del PLC. *//** \brief Initial task * * This task is started automatically in the application mode 1. */TASK(InitTask){       /* init CIAA kernel and devices */   ciaak_start();      PLC_DIOs_Init();      // Se inicializa el Current Result (CR) con el tipo Booleano a true;   CR.TYPE = BOOL;   CR.VALUE.BOOL = true;	   /* activate PLC_SystemTask task:    *  - for the first time after 1 ticks (1 ms)    *  - and then every 10 ticks (10 ms)    */   SetRelAlarm(ActivatePLC_SystemTask, 1, 10);	   /* activate periodic task:    *  - for the first time after 10 ticks (10 ms)    *  - and then every 20 ticks (20 ms)    */   SetRelAlarm(ActivatePeriodicTask, 10, 20);      /* terminate task */   TerminateTask();}/** \brief PLC_System Task * * This task is started automatically every time that the alarm * ActivatePLC_SystemTask expires. This tasks calles the code generated * in IDE4PLC. * */TASK(PLC_SystemTask){   /* Incremet PLC_TimersTime variable that counts time in milliseconds for PLC Timers */   PLC_TimersTime+=10;        /* terminate task */   TerminateTask();}/** \brief Periodic Task * * This task is started automatically every time that the alarm * ActivatePeriodicTask expires. This tasks calles the code generated * in IDE4PLC. * */TASK(PeriodicTask){   /* Lectura de las entradas fisicas */   digitalInputs = PLC_Read_DIs();   I0 = Convert_PLC_BYTE_2_PLC_1ByteRegister(digitalInputs);		   /* LLAMADOS A PROGRAMAS ASOCIADOS A LA TAREA PLC */   MAIN_PROG_BOOL_VAR.TEC1 = !I0.X.x0;   MAIN_PROG_BOOL_VAR.TEC2 = !I0.X.x1;   MAIN_PROG_BOOL_VAR.TEC3 = !I0.X.x2;   MAIN_PROG_BOOL_VAR.TEC4 = !I0.X.x3;   PLC_P_MAIN_PROG_BOOL( &MAIN_PROG_BOOL_VAR );			   Q0.X.x0 = MAIN_PROG_BOOL_VAR.LEDR;   Q0.X.x1 = MAIN_PROG_BOOL_VAR.LEDG;   Q0.X.x2 = MAIN_PROG_BOOL_VAR.LEDB;   Q0.X.x3 = MAIN_PROG_BOOL_VAR.LED1;   Q0.X.x4 = MAIN_PROG_BOOL_VAR.LED2;   Q0.X.x5 = MAIN_PROG_BOOL_VAR.LED3;   /* Escritura de salidas fisicas */   digitalOutputs = Convert_PLC_1ByteRegister_2_PLC_BYTE( Q0 );   PLC_Write_DOs(digitalOutputs);      /* terminate task */   TerminateTask();}